<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3D Model Showcase</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    
    <script type="module" src="https://unpkg.com/@google/model-viewer@3.4.0/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer@3.4.0/dist/model-viewer-legacy.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <script src="script.js" defer></script>
</head>
<body>
    <h1>3D Model Showcase</h1>
    <div class="controls">
        <label for="modelSelect">Select Model:</label>
        <select id="modelSelect"></select>
        <button id="nightModeToggle">Toggle Night Mode</button>
    </div>

    <div id="viewer-wrapper">
        <button class="filter-popup-btn" id="filterPopupBtn" title="Adjust Brightness/Contrast">
            <span style="font-size:1.2em;">&#9881;&#xFE0E;</span> </button>
        <div class="filter-controls" id="filterControls">
            <div class="filter-slider-row">
                <label for="brightnessRange">Brightness</label>
                <input type="range" id="brightnessRange" min="0.5" max="1.5" step="0.01" value="1">
                <span class="filter-value" id="brightnessValue">1.00</span>
            </div>
            <div class="filter-slider-row">
                <label for="contrastRange">Contrast</label>
                <input type="range" id="contrastRange" min="0.5" max="1.5" step="0.01" value="1">
                <span class="filter-value" id="contrastValue">1.00</span>
            </div>
            <button id="closeFilterBtn" style="margin-top:10px;">Close</button>
        </div>

        <model-viewer id="mainViewer"
            src=""
            ar
            ar-modes="scene-viewer webxr quick-look"
            camera-controls
            shadow-intensity="1"
            environment-image="neutral"
            auto-rotate
            alt="3D model preview"
            loading="eager"
            poster=""
            reveal="auto">
            <div id="loadingOverlay" slot="progress-bar" class="loading-overlay">
                <div class="spinner"></div>
                <p>Loading Model...</p>
            </div>
        </model-viewer>

        <button id="arBtn">AR</button>
        <button id="resetViewBtn">Reset View</button>

        <div id="arDialog" class="ar-dialog">
            <div class="ar-dialog-content">
                <h2>Scan to View in AR</h2>
                <canvas id="qrCanvas"></canvas>
                <p>Ensure you have Google Play Services for AR (ARCore) on Android, or view in Safari on iOS.</p>
                <button id="closeArDialogBtn">Close</button>
            </div>
        </div>
    </div>

</body>
</html>